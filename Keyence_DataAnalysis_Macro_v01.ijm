
// ImageJ Macro by Baris Avsaroglu Nov 20 2018 

selectWindow("RPE1 hTERT R4013 A1_XY01_00001_CH3.tif");
run("8-bit Color");
run("8-bit");
selectWindow("RPE1 hTERT R4013 A1_XY01_00002_CH3.tif");
run("8-bit");
selectWindow("RPE1 hTERT R4013 A1_XY01_00003_CH3.tif");
run("8-bit");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
run("8-bit");
selectWindow("RPE1 hTERT R4013 A1_XY01_00001_CH3.tif");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00003_CH3.tif");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00002_CH3.tif");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00001_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00002_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00003_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00003_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("In [+]");
run("In [+]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("In [+]");
run("In [+]");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("In [+]");
run("In [+]");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("8-bit");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
run("8-bit");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
run("8-bit");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
run("8-bit");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
run("8-bit");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
run("Enhance Contrast", "saturated=0.35");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
run("In [+]");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00001_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00002_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00003_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00004_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00005_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00006_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00007_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00008_CH3.tif");
run("Save");
selectWindow("RPE1 hTERT R4013 A1_XY01_00009_CH3.tif");
run("Save");
run("Grid/Collection stitching", "type=[Grid: snake by rows] order=[Right & Down                ] grid_size_x=3 grid_size_y=3 tile_overlap=20 first_file_index_i=1 directory=[/Users/barisavsaroglu/Desktop/Goga Lab/research/MetSensor/image analysis/test dataset/Controls/XY01/green channel] file_names=[RPE1 hTERT R4013 A1_XY01_{iiiii}_CH3.tif] output_textfile_name=TileConfiguration.txt fusion_method=[Linear Blending] regression_threshold=0.30 max/avg_displacement_threshold=2.50 absolute_displacement_threshold=3.50 compute_overlap ignore_z_stage display_fusion computation_parameters=[Save memory (but be slower)] image_output=[Fuse and display]");
//run("Brightness/Contrast...");
run("Enhance Contrast", "saturated=0.35");
run("In [+]");
run("In [+]");
run("In [+]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("In [+]");
run("In [+]");
run("In [+]");
run("In [+]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("Out [-]");
run("In [+]");
run("Out [-]");
saveAs("Tiff", "/Users/barisavsaroglu/Desktop/Goga Lab/research/MetSensor/image analysis/test dataset/Controls/XY01/green channel/Fused.tif");
selectWindow("RPE1 hTERT R4013 A1_XY01_00001_CH1.tif");
close();
run("Grid/Collection stitching", "type=[Positions from file] order=[Defined by TileConfiguration]");
run("Close");
saveAs("Tiff", "/Users/barisavsaroglu/Desktop/Goga Lab/research/MetSensor/image analysis/test dataset/Controls/XY01/green channel/Stitched RPE1 hTERT R4013 A1_XY01_CH3.tif");
run("Close All");
